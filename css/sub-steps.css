/**
 * Sub-Steps Container and Layout
 * ==============================
 * 
 * Enhanced sub-steps styling with opacity-based animations
 */

/**
 * Sub-Steps Container
 * Main container for sub-steps with opacity animations
 */
.sub-steps-container {
    margin-top: var(--spacing-md);
    border: 1px solid var(--c-border);
    border-radius: var(--border-radius-md);
    background: var(--c-bg-surface-2);
    overflow: hidden;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.sub-steps-container:hover {
    border-color: color-mix(in srgb, var(--c-primary) 20%, var(--c-border));
    box-shadow: 0 2px 8px color-mix(in srgb, var(--c-primary) 15%, var(--c-shadow));
}

/**
 * Sub-Steps Container Collapsed State
 */
.sub-steps-container.collapsed .sub-steps-list {
    max-height: 0;
    opacity: 0;
    overflow: hidden;
}

.sub-steps-container:not(.collapsed) .sub-steps-list {
    max-height: 1000px;
    opacity: 1;
}

/**
 * Sub-Steps Header
 * Clickable header to toggle sub-steps visibility
 */
.sub-steps-header {
    padding: var(--spacing-sm) var(--spacing-md);
    background: linear-gradient(135deg, var(--c-bg-surface-2), var(--c-bg-surface-hover));
    border-bottom: 1px solid var(--c-border);
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background-color 0.2s ease;
}

.sub-steps-header:hover {
    background: linear-gradient(135deg, var(--c-bg-surface-hover), color-mix(in srgb, var(--c-primary) 8%, var(--c-bg-surface-hover)));
}

.sub-steps-header:active {
    opacity: 0.9;
}

/**
 * Sub-Steps Header Left Section
 */
.sub-steps-header-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: 0.9em;
    font-weight: 600;
    color: var(--c-text-primary);
    transition: color 0.2s ease;
}

.sub-steps-header:hover .sub-steps-header-left {
    color: var(--c-primary);
}

/**
 * Sub-Steps Toggle Button
 */
.sub-steps-toggle-btn {
    background: none;
    border: none;
    cursor: pointer;
    color: var(--c-text-secondary);
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    border-radius: var(--border-radius-sm);
    transition: color 0.2s ease, background-color 0.2s ease, transform 0.2s ease;
}

.sub-steps-toggle-btn:hover {
    color: var(--c-primary);
    background: color-mix(in srgb, var(--c-primary) 10%, transparent);
}

.sub-steps-toggle-btn:active {
    opacity: 0.8;
}

/**
 * Toggle Button Rotation for Collapsed State
 */
.sub-steps-container.collapsed .sub-steps-toggle-btn svg {
    transform: rotate(-90deg);
}

.sub-steps-container:not(.collapsed) .sub-steps-toggle-btn svg {
    transform: rotate(0deg);
}

/**
 * Sub-Steps Progress Display
 */
.sub-steps-progress {
    font-size: 0.85em;
    font-weight: 600;
    background: rgba(255, 255, 255, 0.2);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--border-radius-md);
    backdrop-filter: blur(4px);
    margin-right: var(--spacing-sm);
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    transition: background 0.2s ease;
}

.sub-steps-header:hover .sub-steps-progress {
    background: rgba(255, 255, 255, 0.3);
}

/**
 * Sub-Steps Progress Bar
 */
.sub-steps-progress-bar {
    width: 40px;
    height: 4px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: var(--border-radius-sm);
    overflow: hidden;
}

.sub-steps-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--c-primary), var(--c-primary-light));
    border-radius: var(--border-radius-sm);
    transition: width 0.3s ease, filter 0.2s ease;
}

.sub-steps-header:hover .sub-steps-progress-fill {
    filter: brightness(1.1);
}

/**
 * Sub-Steps List Container
 */
.sub-steps-list {
    transition: max-height 0.2s ease, opacity 0.2s ease;
}

/**
 * Individual Sub-Step
 */
.sub-step {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
    padding: var(--spacing-sm) var(--spacing-md);
    border-bottom: 1px solid var(--c-border);
    cursor: pointer;
    transition: background-color 0.2s ease;
    position: relative;
}

.sub-step:last-child {
    border-bottom: none;
}

.sub-step:hover {
    background: color-mix(in srgb, var(--c-primary) 8%, transparent);
}

.sub-step:active {
    opacity: 0.9;
}

/**
 * Sub-Step Checkbox
 */
.sub-step-checkbox {
    margin: 0;
    flex-shrink: 0;
    width: 16px;
    height: 16px;
    accent-color: var(--c-primary);
    cursor: pointer;
    pointer-events: none;
    margin-top: 2px;
    transition: filter 0.2s ease;
}

.sub-step:hover .sub-step-checkbox {
    filter: brightness(1.1) drop-shadow(0 1px 3px color-mix(in srgb, var(--c-primary) 20%, transparent));
}

.sub-step:active .sub-step-checkbox {
    filter: brightness(0.95);
}

/**
 * Sub-Step Content
 */
.sub-step-content {
    flex: 1;
    min-width: 0;
}

/**
 * Sub-Step Title
 */
.sub-step-title {
    font-weight: 600;
    font-size: 0.9em;
    color: var(--c-text-primary);
    margin-bottom: var(--spacing-xs);
    line-height: 1.4;
    transition: color 0.2s ease;
}

.sub-step:hover .sub-step-title {
    color: var(--c-primary);
}

/**
 * Sub-Step Instruction
 */
.sub-step-instruction {
    font-size: 0.85em;
    color: var(--c-text-secondary);
    line-height: 1.5;
    margin-bottom: var(--spacing-xs);
    transition: color 0.2s ease;
}

.sub-step:hover .sub-step-instruction {
    color: var(--c-text-primary);
}

/**
 * Sub-Step Time
 */
.sub-step-time {
    font-size: 0.75em;
    font-weight: 600;
    color: var(--c-primary);
    background: color-mix(in srgb, var(--c-primary) 10%, transparent);
    padding: 2px 6px;
    border-radius: var(--border-radius-sm);
    display: inline-block;
    transition: filter 0.2s ease;
}

.sub-step:hover .sub-step-time {
    filter: brightness(1.1);
}

/**
 * Sub-Step Completed State
 */
.sub-step.completed {
    background: color-mix(in srgb, var(--c-success) 8%, transparent);
}

.sub-step.completed .sub-step-title {
    text-decoration: line-through;
    color: var(--c-text-secondary);
}

.sub-step.completed .sub-step-instruction {
    color: color-mix(in srgb, var(--c-text-secondary) 70%, transparent);
    text-decoration: line-through;
}

/**
 * Mobile Responsive Design
 */
@media (max-width: 768px) {
    .sub-steps-header {
        padding: var(--spacing-xs) var(--spacing-sm);
    }
    
    .sub-steps-progress {
        font-size: 0.8em;
        padding: 2px 6px;
        margin-right: var(--spacing-xs);
    }
    
    .sub-steps-progress-bar {
        width: 30px;
        height: 3px;
    }
    
    .sub-step {
        padding: var(--spacing-xs) var(--spacing-sm);
        gap: var(--spacing-xs);
    }
    
    .sub-step-checkbox {
        width: 14px;
        height: 14px;
    }
    
    .sub-step-title {
        font-size: 0.85em;
    }
    
    .sub-step-instruction {
        font-size: 0.8em;
    }
    
    .sub-step-time {
        font-size: 0.7em;
        padding: 1px 4px;
    }
}

@media (max-width: 480px) {
    .sub-steps-header-left {
        font-size: 0.85em;
    }
    
    .sub-steps-progress {
        font-size: 0.75em;
    }
    
    .sub-step-title {
        font-size: 0.8em;
    }
    
    .sub-step-instruction {
        font-size: 0.75em;
    }
}